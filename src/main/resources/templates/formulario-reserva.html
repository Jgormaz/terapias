<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Formulario de Reserva</title>
    <meta charset="UTF-8">
</head>
<body>
    <h1>Formulario de Reserva</h1>

    <h2>Datos del Terapeuta</h2>
    <p><strong>Nombre:</strong> <span th:text="${reservaDTO.nombreTerapeuta}"></span></p>
    <p><strong>Servicio:</strong> <span th:text="${reservaDTO.nombreServicio}"></span></p>

    <h2>Fecha y Hora</h2>
    <p><strong>Fecha:</strong> 
        <span th:text="${#temporals.format(reservaDTO.fecha, 'dd/MM/yyyy')}"></span>
    </p>
    <p><strong>Hora:</strong> 
        <span th:text="${#temporals.format(reservaDTO.horaIni, 'HH:mm')}"></span> - 
        <span th:text="${#temporals.format(reservaDTO.horaFin, 'HH:mm')}"></span>
    </p>

    <h2>Precio</h2>
    <p><strong>$</strong><span th:text="${reservaDTO.precio}"></span></p>

    <form th:action="@{/reservas/confirmar}" th:object="${reservaDTO}" method="post">
        <input type="hidden" th:field="*{idBloque}" />
        <input type="hidden" th:field="*{idTerapeuta}" />
        <input type="hidden" th:field="*{idServicio}" />

        <h2>Buscar o Registrar Paciente</h2>
        <label for="correo">Correo Electrónico:</label>
        <input type="email" id="correo" th:field="*{correoPaciente}" required />
        <button type="submit" formaction="#" formmethod="get">Buscar</button>

        <div th:if="${pacienteExistente}">
            <h3>Datos del Paciente</h3>
            <p><strong>Nombre:</strong> <span th:text="${reservaDTO.nombrePaciente}"></span></p>
            <p><strong>Teléfono:</strong> <span th:text="${reservaDTO.telefonoPaciente}"></span></p>
        </div>

        <div th:if="${!pacienteExistente}">
            <h3>Nuevo Paciente</h3>
            <label for="nombre">Nombre:</label>
            <input type="text" id="nombre" th:field="*{nombrePaciente}" required />

            <label for="apellido">Apellido:</label>
            <input type="text" id="apellido" th:field="*{apellidoPaciente}" required />

            <label for="telefono">Teléfono:</label>
            <input type="text" id="telefono" th:field="*{telefonoPaciente}" required />

            <label for="direccion">Dirección:</label>
            <input type="text" id="direccion" th:field="*{direccionPaciente}" required />

    <!--        <label for="region">Región:</label>
            <select id="region" th:field="*{idRegion}">
                <option th:each="region : ${regiones}" 
                        th:value="${region.id}" 
                        th:text="${region.nombre}">
                </option>
            </select>

            <label for="comuna">Comuna:</label>
            <select id="comuna" th:field="*{idComuna}">
                <option th:each="comuna : ${comunas}" 
                        th:value="${comuna.id}" 
                        th:text="${comuna.nombre}">
                </option>
            </select> -->
        </div>

        <br/>
        <button type="submit">Confirmar Reserva</button>
    </form>
</body>
</html>
