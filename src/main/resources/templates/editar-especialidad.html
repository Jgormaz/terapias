<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Editar Especialidad</title>
    <link rel="stylesheet" href="/css/styles.css">
</head>
<body>
    <h2>Editar Especialidad</h2>

    <form th:action="@{/especialidades/actualizar}" method="post" th:object="${especialidad}">
        <!-- Campo oculto con el ID de la especialidad -->
        <input type="hidden" th:field="*{idEspecialidad}"/>

        <label>Nombre:</label>
        <input type="text" th:field="*{nombre}" required />

        <label>Descripción:</label>
        <input type="text" th:field="*{descripcion}" required />

        <h3>Servicios:</h3>
        <div id="servicios-container">
            <!-- Listar los servicios existentes -->
            <div th:each="servicio, stat : *{servicios}">
                <!-- Campo oculto para el ID del servicio -->
                <label>ID del Servicio:</label>
                <input type="text" th:field="*{servicios[__${stat.index}__].idServicio}" required />

                <label>Nombre del Servicio:</label>
                <input type="text" th:field="*{servicios[__${stat.index}__].nombre}" required />

                <button type="button" th:onclick="|eliminarServicio(this)|">Eliminar</button>
            </div>
        </div>

        <!-- Botón para agregar un nuevo servicio -->
        <button type="button" onclick="agregarServicio()">Agregar Servicio</button>

        <button type="submit">Actualizar</button>
    </form>

    <a href="/especialidades">Cancelar</a>

    <script type="text/javascript">
        // Función para agregar un nuevo servicio dinámicamente
        function agregarServicio() {
            const container = document.getElementById('servicios-container');
            const index = container.children.length;

            const newService = document.createElement('div');
            newService.innerHTML = `
                <label>ID del Servicio:</label>
                <input type="text" name="servicios[${index}].idServicio" required />

                <label>Nombre del Servicio:</label>
                <input type="text" name="servicios[${index}].nombre" required />

                <button type="button" onclick="eliminarServicio(this)">Eliminar</button>
            `;

            container.appendChild(newService);
        }

        // Función para eliminar un servicio del formulario
        function eliminarServicio(button) {
            button.parentElement.remove();
        }
    </script>
</body>
</html>

